---
phase: 01-vdi-faq-ingestion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [scripts/ingest-vdi-faq.ts, src/types/index.ts]
autonomous: true
---

<objective>
Create VDI FAQ scraping and ingestion script.

Purpose: Scrape VDI FAQ from https://vdi.lrv.lt/lt/dazniausiai-uzduodami-klausimai/ and ingest Q&A pairs into Pinecone as a new `vdi_faq` document type.
Output: Working ingestion script that populates Pinecone with VDI FAQ content.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-vdi-faq-ingestion/01-CONTEXT.md

# Existing ingestion pattern to follow:
@scripts/ingest-nutarimai.ts

# Pinecone types and search:
@src/lib/pinecone/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VDI FAQ scraping and ingestion script</name>
  <files>scripts/ingest-vdi-faq.ts</files>
  <action>
Create script following ingest-nutarimai.ts pattern:

1. Fetch HTML from https://vdi.lrv.lt/lt/dazniausiai-uzduodami-klausimai/
2. Parse accordion structure to extract Q&A pairs:
   - Questions are in clickable accordion headers
   - Answers are in accordion body content
   - Categories from h5 headings (optional metadata)
3. For each Q&A pair:
   - Generate embedding using text-embedding-004
   - Create vector with metadata:
     - docType: 'vdi_faq'
     - docId: 'vdi-faq-{index}'
     - question: the question text
     - text: the answer text (for retrieval)
     - category: parent category if available
     - sourceUrl: 'https://vdi.lrv.lt/lt/dazniausiai-uzduodami-klausimai/'
4. Upsert to Pinecone in batches

Use cheerio or similar for HTML parsing (check if already in deps, else use built-in fetch + regex).
Add rate limiting between embedding calls (100ms delay every 5 items).
Log progress: "Processing {n}/{total} FAQ items..."
  </action>
  <verify>npx tsx scripts/ingest-vdi-faq.ts --dry-run (add dry-run flag that parses but doesn't upsert)</verify>
  <done>Script parses VDI FAQ page and extracts 40+ Q&A pairs with categories</done>
</task>

<task type="auto">
  <name>Task 2: Add vdi_faq to docType union</name>
  <files>src/lib/pinecone/index.ts</files>
  <action>
Update the SearchResult interface docType union to include 'vdi_faq':

Change:
  docType: 'legislation' | 'nutarimas' | 'lat_ruling'

To:
  docType: 'legislation' | 'nutarimas' | 'lat_ruling' | 'vdi_faq'

Also add vdi_faq-specific metadata fields to the interface:
  question?: string;  // For vdi_faq - the original question
  category?: string;  // For vdi_faq - FAQ category
  </action>
  <verify>npx tsc --noEmit</verify>
  <done>TypeScript compiles with vdi_faq as valid docType</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsx scripts/ingest-vdi-faq.ts --dry-run` runs without errors
- [ ] Script logs 40+ FAQ items parsed
- [ ] `npx tsc --noEmit` passes
- [ ] No linting errors in modified files
</verification>

<success_criteria>

- VDI FAQ scraping script created and tested (dry-run)
- vdi_faq docType added to TypeScript types
- Script ready for actual ingestion (will run in Plan 03)
</success_criteria>

<output>
After completion, create `.planning/phases/01-vdi-faq-ingestion/01-01-SUMMARY.md`
</output>
