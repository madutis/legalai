---
phase: 06-subscription-billing
plan: 03
type: execute
wave: 2
depends_on: ["06-01", "06-02"]
files_modified: [src/components/subscription/SubscriptionStatus.tsx, src/app/account/page.tsx]
autonomous: true
---

<objective>
Create subscription status card for account page showing trial info, active subscription, or renewal prompt.

Purpose: Users need to see their subscription status and manage their subscription from the account page.
Output: SubscriptionStatus component integrated into account page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-subscription-billing/06-CONTEXT.md

@src/app/account/page.tsx
@src/contexts/SubscriptionContext.tsx
@src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SubscriptionStatus component</name>
  <files>src/components/subscription/SubscriptionStatus.tsx</files>
  <action>
Create `src/components/subscription/SubscriptionStatus.tsx`:

A card component that shows different states based on subscription status.

1. Use `useSubscription()` to get status, userDoc, trialDaysLeft, isSubscribed

2. **Loading state**: Show skeleton/spinner

3. **Pre-trial state** (no trialStartedAt):
```
┌─────────────────────────────────────┐
│ Pradėkite naudotis                  │
│                                     │
│ Užduokite pirmą klausimą ir         │
│ gausite 7 dienų bandomąjį laikotarpį│
│                                     │
│ Po bandomojo laikotarpio:           │
│ €29/mėn. + PVM arba €299/m. + PVM   │
└─────────────────────────────────────┘
```

4. **Trial active** (trialStartedAt set, no subscription):
```
┌─────────────────────────────────────┐
│ Bandomasis laikotarpis              │
│ Liko {trialDaysLeft} d.             │
│                                     │
│ Po bandomojo laikotarpio:           │
│ €29/mėn. + PVM arba €299/m. + PVM   │
│                                     │
│ [Prenumeruoti dabar]                │
└─────────────────────────────────────┘
```

5. **Trial expired** (trial ended, no subscription):
```
┌─────────────────────────────────────┐
│ Bandomasis laikotarpis baigėsi      │
│                                     │
│ Tęskite naudojimąsi:                │
│ €29/mėn. + PVM arba €299/m. + PVM   │
│                                     │
│ [Prenumeruoti]                      │
└─────────────────────────────────────┘
```

6. **Active subscription**:
```
┌─────────────────────────────────────┐
│ Aktyvi prenumerata                  │
│ €29/mėn. + PVM (or yearly)          │
│ Atnaujinama: {date}                 │
│                                     │
│ [Tvarkyti prenumeratą]              │
└─────────────────────────────────────┘
```

7. **Canceled subscription** (cancelAtPeriodEnd: true):
```
┌─────────────────────────────────────┐
│ Prenumerata atšaukta                │
│ Prieiga iki: {currentPeriodEnd}     │
│                                     │
│ [Atnaujinti prenumeratą]            │
└─────────────────────────────────────┘
```

8. **Subscription expired**:
Same as trial expired - prompt to subscribe.

Button actions:
- "Prenumeruoti" / "Prenumeruoti dabar" / "Atnaujinti prenumeratą": Call `/api/stripe/create-checkout-session` with monthly price, redirect to URL
- "Tvarkyti prenumeratą": Call `/api/stripe/create-portal-session`, redirect to URL

Add loading state to buttons while API call in progress.

Style to match existing card in account page (use same bg-card, border-border, shadow-sm pattern).
Format dates in Lithuanian locale (toLocaleDateString('lt-LT')).
  </action>
  <verify>Build passes: `npm run build`</verify>
  <done>SubscriptionStatus component handles all subscription states with appropriate UI and actions.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate SubscriptionStatus into account page</name>
  <files>src/app/account/page.tsx</files>
  <action>
Update account page to include SubscriptionStatus:

1. Import SubscriptionStatus component
2. Add SubscriptionStatus card above the existing user info card
3. Keep existing user info card and sign out button as-is

Layout:
```
[SubscriptionStatus card]    ← NEW
[User info card with avatar and sign out]  ← existing
```

Both cards should have same max-width (max-w-md) for consistency.
Add small gap (space-y-4) between cards.
  </action>
  <verify>Build passes: `npm run build`</verify>
  <done>Account page shows subscription status above user info.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] SubscriptionStatus component renders for all states
- [ ] Subscribe button calls checkout API and redirects
- [ ] Manage subscription button calls portal API and redirects
- [ ] Account page shows subscription card
</verification>

<success_criteria>

- All tasks completed
- All subscription states render correctly
- Buttons trigger correct API calls
- Account page layout is clean and consistent
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-subscription-billing/06-03-SUMMARY.md`
</output>
