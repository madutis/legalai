---
phase: 01.2-darbo-sauga
plan: 03
subsystem: ui-integration
tags: [safety, topic, ui, chat, llm, citations]

requires:
  - phase: 01.2-01
    provides: DSS Istatymas articles in Pinecone (lawCode=DSS)
  - phase: 01.2-02
    provides: VDI safety documents in Pinecone (category=safety)
provides:
  - Darbo sauga topic selectable in UI
  - Safety topic display in chat header
  - DSS citation guidance in LLM prompt
  - DSS source links with correct e-TAR URLs
affects: [landing-page, chat-page, llm-prompts, source-rendering]

tech-stack:
  added: []
  patterns:
    - lawCode-based source label differentiation
    - lawCode-based e-TAR URL routing

key-files:
  created: []
  modified:
    - src/types/index.ts
    - src/lib/topics.ts
    - src/app/page.tsx
    - src/app/chat/page.tsx
    - src/lib/gemini/index.ts
    - src/components/chat/ChatInterface.tsx

key-decisions:
  - "Shield icon for safety topic (protection theme)"
  - "DSS source label format: 'DSS X str.' vs 'DK X str.'"

patterns-established:
  - "lawCode-based differentiation for multi-legislation support"

duration: 12min
completed: 2026-01-21
---

# Phase 01.2 Plan 03: Safety Topic UI Integration Summary

**Darbo sauga topic fully integrated into UI with DSS citation support**

## Performance

- **Duration:** 12 min
- **Started:** 2026-01-21
- **Completed:** 2026-01-21
- **Tasks:** 5/5
- **Files modified:** 6

## Accomplishments

- Added 'safety' to ConsultationTopic type union
- Created safety topic config with sub-questions (training, incidents, remote work, rules, general)
- Added shield icon and "Darbo sauga" label to landing page topic selection
- Added safety topic label and icon to chat page header
- Updated LLM system prompt with DSS citation guidance
- Added lawCode-aware source rendering for DSS Istatymas sources

## Task Commits

Each task was committed atomically:

1. **Task 1: Add safety topic type and config** - `6c9f302` (feat)
2. **Task 2: Add safety topic to landing page UI** - `55280ac` (feat)
3. **Task 3: Add safety topic to chat page** - `d47b460` (feat)
4. **Task 4: Update LLM prompt for DSS citations** - `9b9c2ad` (feat)
5. **Task 5: Add DSS source link rendering** - `ca2f597` (feat)

## Files Created/Modified

- `src/types/index.ts` - Added 'safety' to ConsultationTopic union
- `src/lib/topics.ts` - Added safety topic config with questions
- `src/app/page.tsx` - Added safety icon and topic in landing page
- `src/app/chat/page.tsx` - Added safety label and icon in chat header
- `src/lib/gemini/index.ts` - Added DSS citation guidance to system prompt
- `src/components/chat/ChatInterface.tsx` - Added lawCode field and DSS source rendering

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| Shield icon for safety | Visual representation of protection/safety theme |
| "DSS X str." label format | Clear differentiation from "DK X str." for Darbo Kodeksas |
| Separate e-TAR URL routing | DSS uses different document ID (TAR.95C79D036AA4) |

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None - all tasks completed without issues.

## User Setup Required

None - no external service configuration required.

## Verification Completed

- [x] `npm run build` succeeds
- [x] Darbo sauga topic visible on landing page
- [x] Darbo sauga label correct in chat header
- [x] DSS source links use correct e-TAR URL
- [x] TypeScript compiles without errors

## Phase 01.2 Status

With this plan complete, Phase 01.2 (Darbo Sauga) is now fully implemented:
- Plan 01: DSS Istatymas ingested (50 articles)
- Plan 02: VDI safety documents ingested (3548 chunks from 95 docs)
- Plan 03: UI integration complete with topic selection and citation support

Users can now:
1. Select "Darbo sauga" topic on landing page
2. Ask occupational safety questions
3. Get answers citing DSS Istatymas and VDI safety documents
4. Click source chips to view DSS articles on e-TAR

---
*Phase: 01.2-darbo-sauga*
*Completed: 2026-01-21*
