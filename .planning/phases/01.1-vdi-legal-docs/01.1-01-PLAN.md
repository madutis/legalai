---
phase: 01.1-vdi-legal-docs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [scripts/discover-vdi-content.ts, package.json]
autonomous: true
---

<objective>
Discover and classify VDI guidance content for accountant relevance.

Purpose: Map available VDI content (atmintinės, topic pages, news) and use LLM to classify which documents are Tier 1 (essential for accountants).
Output: A discovery script that outputs classified content list, and a JSON manifest of Tier 1 documents ready for ingestion.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-vdi-faq-ingestion/01-01-SUMMARY.md

# Existing ingestion script for reference:
@scripts/ingest-vdi-faq.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VDI content discovery script</name>
  <files>scripts/discover-vdi-content.ts</files>
  <action>
Create a script that:

1. **Crawl known VDI content sources** (no full site crawl - targeted):
   - Atmintinės page: https://vdi.lrv.lt/lt/darbo-teise/atmintines-darbuotojams-ir-darbdaviams/
   - Employer guidance: https://vdi.lrv.lt/lt/darbo-teise/darbdaviams/
   - Employee guidance: https://vdi.lrv.lt/lt/darbo-teise/darbuotojams/

2. **Extract content items** using cheerio:
   - PDF links (href ending in .pdf)
   - Topic page links (subpages under /darbo-teise/)
   - Extract title, URL, and brief description if available

3. **For each PDF found**: Download and extract text using pdf-parse

4. **Classify with Gemini** using this prompt:
   ```
   You are classifying VDI (State Labor Inspectorate) guidance documents for relevance to Lithuanian accountants and bookkeepers who handle employment administration.

   Tier 1 (essential - ingest): Employment contracts, working time/pay, VDU calculation, leave management, termination procedures
   Tier 2 (useful - ingest): Occupational safety reporting basics, labor dispute basics
   Tier 3 (skip): Detailed safety inspections, technical regulations, inspector procedures

   Document title: {title}
   Document content (first 2000 chars): {content}

   Respond with JSON: {"tier": 1|2|3, "reason": "brief explanation", "topics": ["topic1", "topic2"]}
   ```

5. **Output manifest** to `data/vdi-content-manifest.json`:
   ```json
   {
     "discovered": "2026-01-20T...",
     "sources_crawled": [...],
     "items": [
       {
         "id": "atmintine-vdu",
         "title": "Vidutinio darbo užmokesčio skaičiavimo atmintinė",
         "type": "pdf",
         "url": "https://...",
         "tier": 1,
         "reason": "...",
         "topics": ["vdu", "salary"],
         "content_preview": "first 500 chars..."
       }
     ]
   }
   ```

**Implementation notes:**
- Follow ingest-vdi-faq.ts patterns: lazy init, dry-run flag, cheerio parsing
- Use fetch with same headers as FAQ script
- Rate limit: 500ms between page fetches, 200ms between LLM calls
- Skip documents already in manifest if re-running (check by URL)
- Handle PDF download failures gracefully (log and continue)
  </action>
  <verify>npx tsx scripts/discover-vdi-content.ts --dry-run succeeds and shows discovered items</verify>
  <done>Script discovers 10+ content items from VDI pages and classifies them</done>
</task>

<task type="auto">
  <name>Task 2: Run discovery and generate manifest</name>
  <files>data/vdi-content-manifest.json</files>
  <action>
1. Run the discovery script: `npx tsx scripts/discover-vdi-content.ts`
2. Review the manifest output
3. Verify Tier 1 items include expected documents:
   - VDU calculation atmintinė
   - Employment contract termination grounds
   - Cumulative working time atmintinė
   - Remote work guidance
   - Annual leave information

If key documents are missing Tier 1 classification, adjust the LLM prompt and re-run.
  </action>
  <verify>cat data/vdi-content-manifest.json shows Tier 1 documents including VDU and termination guides</verify>
  <done>Manifest contains 5+ Tier 1 documents relevant to accountants</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Discovery script runs without errors
- [ ] Manifest file exists with classified content
- [ ] Tier 1 includes VDU calculation and termination documents
- [ ] No hardcoded API keys (uses env vars)
</verification>

<success_criteria>
- Discovery script created following existing patterns
- Manifest JSON generated with tiered classification
- At least 5 Tier 1 documents identified
- Ready for Plan 02 ingestion
</success_criteria>

<output>
After completion, create `.planning/phases/01.1-vdi-legal-docs/01.1-01-SUMMARY.md`
</output>
